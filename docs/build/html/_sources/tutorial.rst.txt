Tutorial
============

This tutorial introduces the text-based usage and workflow in featurExtract.
featurExtract is designed for GFF and GTF file, meanwhile GenBankExtract is suited for GenBank file.


`featurExtract` is `tested <https://github.com/SitaoZ/featurExtract>`_ with Python 3.8

Quick-start
-----------

Find featurextract in command line and show the commands provided.

.. code-block:: bash
    :linenos:
     
    # find the featurExtract exec path
    which featurExtract
    /opt/anaconda3/bin/featurExtract
    # show help info
    featurExtract -h 
    #    Program:  featurExtract (pipeline for genomic feature extract)
    #    Version:  0.2.5.3
    #    Contact:  Sitao Zhu <zhusitao1990@163.com>
    #    Usage  :  featurExtract <command> [parameters] 
    #    Command: 
    #        create        create database for GTF or GFF
    #        coverage      read coverage by transcript models
    #        CDS           extract CDS for gene or genome
    #        cdna          extract cdna (refMrna) sequence fo gene or genome
    #        dORF          extract downstream (dORF) for gene or genome
    #        exon          extract exon for transcript
    #        gene          extract gene sequence fo gene or genome
    #        intron        extract intron for transcript
    #        IGR           extract intergenic region (IGR) between genes
    #        mRNA          extract mature messager RNA for transcript
    #        promoter      extract promoter for gene or genome
    #        terminator    extract terminator for gene or genome
    #        uORF          extract upstream ORF (uORF) for gene or genome
    #        UTR           extract untranslated region (UTR) for gene or genome
 
Main functional commands
------------------------
In this section, we will introduce commands provided by featurExtract modual.
How to get help info, and how to use them. Subcommands are show helpdoc when 
the specific command is provided as args in command line.

Create
~~~~~~
The create command use `gffutils <https://github.com/daler/gffutils>`_ to build a sqlite database, which 
stores the genome and gene structure need for other functional commands in featurExtract.

.. code-block:: bash
    :linenos:
    
    featurExtract create -h 
    #    usage: featurExtract create [-h] [-f {GFF,GTF}] -g GENOMEFEATURE -o OUTPUT_PREFIX
    #    optional arguments:
    #        -h, --help            show this help message and exit
    #        -f {GFF,GTF}, --file_type {GFF,GTF}
    #                      genome annotation file
    #        -g GENOMEFEATURE, --genomefeature GENOMEFEATURE
    #                      genome annotation file
    #        -o OUTPUT_PREFIX, --output_prefix OUTPUT_PREFIX
    #                      database absolute path
    
    # GFF  
    featurExtract create -f GFF -g ath.gff3 -o ath
    # or GTF 
    featurExtract create -f GTF -g ath.gtf  -o ath

Promoter
~~~~~~~~
Promoter sequence is essential for gene functional resaerch. Usually.

.. code-block:: bash
    :linenos:
    
    featurExtract promoter -h 
    #usage: featurExtract promoter [-h] -d DATABASE -f GENOME [-g GENE]
    #                           [-l PROMOTER_LENGTH] [-u UTR5_UPPER_LENGTH]
    #                           [-o OUTPUT] [-t {csv,fasta}] [-p]
    #optional arguments:
    #  -h, --help            show this help message and exit
    #  -d DATABASE, --database DATABASE
    #                        database generated by subcommand create
    #  -f GENOME, --genome GENOME
    #                        genome fasta path
    #  -g GENE, --gene GENE  specific gene; if not given, return whole genes
    #  -l PROMOTER_LENGTH, --promoter_length PROMOTER_LENGTH
    #                        promoter length before TSS (default 100 nt)
    #  -u UTR5_UPPER_LENGTH, --utr5_upper_length UTR5_UPPER_LENGTH
    #                        5' utr length after TSS (default 10 nt)
    #  -o OUTPUT, --output OUTPUT
    #                        output file path
    #  -t {csv,fasta}, --output_format {csv,fasta}
    #                        output format
    #  -p, --print           output to stdout
    
    # All genes in whole gnome
    featurExtract promoter -d ath.GFF -f ath.fa -l 200 -u 100 -o promoter.csv --output_format fasta
    # A given gene
    featurExtract promoter -d ath.GFF -f ath.fa -l 200 -u 100 -g AT1G01010 -p --output_format fasta
    
 
UTR
~~~
UTR (untranslated region) sequence is essential for gene functional resaerch. In molecular genetics, 
an UTR refers to either of two sections, one on each side of a coding sequence on a strand of mRNA. 
If it is found on the 5' side, it is called the 5' UTR (or leader sequence), or if it is found on 
the 3' side, it is called the 3' UTR (or trailer sequence).

.. code-block:: bash
    :linenos:
    
    featurExtract UTR -h 
    #usage: featurExtract UTR [-h] -d DATABASE -f GENOME [-i TRANSCRIPT]
    #                     [-o OUTPUT] [-p] [-s {GFF,GTF}]
    #
    #optional arguments:
    #  -h, --help            show this help message and exit
    #  -d DATABASE, --database DATABASE
    #                        database generated by subcommand create
    #  -f GENOME, --genome GENOME
    #                        genome fasta file
    #  -i TRANSCRIPT, --transcript TRANSCRIPT
    #                        specific transcript id; if not given, whole transcript
    #                        will return
    #  -o OUTPUT, --output OUTPUT
    #                        output file path
    #  -p, --print           output to stdout
    #  -s {GFF,GTF}, --style {GFF,GTF}
                            GTF database or GFF database
    #
    # All transcripts in whole gnome
    featurExtract promoter -d ath.GFF -f ath.fa -o utr.csv -s GFF
    # A given gene
    featurExtract promoter -d ath.GFF -f ath.fa -i AT1G01010.1 -p -s GFF
    
featurExtract uORF -h 
featurExtract CDS -h 
featurExtract dORF -h
featurExtract exon -h
featurExtract intron -h
featurExtract intergenic -h

* python >= 3.7.6 `python <https://www.python.org/>`_
* pandas >= 1.2.4 `pandas <https://pandas.pydata.org/docs/>`_
* gffutils >= 0.10.1 `gffutils <https://pythonhosted.org/gffutils/>`_
* setuptools >= 49.2.0 `setuptools <https://pypi.org/project/setuptools/>`_
* BioPython >= 1.78 `biopython <https://biopython.org/wiki/Documentation/>`_

Install them all with `conda`::

    conda install --channel conda-forge --channel python pandas gffutils setuptools biopython

Basics
------
